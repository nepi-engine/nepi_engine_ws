
###################################
#Dev Shortcuts
###################################
# Function to search for text
# Example call: find 'nepi_sdk.parse_header_msg'
function ftext(){
grep -r "$@" ./*
}

# Function to search for text
# Example call: find 'nepi_sdk.parse_header_msg'
function ffile(){
find ./* -iname  "*$@*" 
}

NEEDS_ROS=1
# Function to search for topic containing string
function sros(){
# Source ROS Env
source /opt/nepi/nepi_engine/setup.bash
NEEDS_ROS=0
}

# Function to search for topic containing string
function ftopic(){
if [ $NEEDS_ROS == 1 ]; then
  sleep 1 & sros
  wait
  NEEDS_ROS=0
fi
rostopic list | grep "$@" 
}

# Function to print all topics out
function ltopics(){
if [ $NEEDS_ROS == 1 ]; then
  sleep 1 & sros
  wait
  NEEDS_ROS=0
fi
rostopic list
}

# Function to listen to topic
function etopic(){
if [ $NEEDS_ROS == 1 ]; then
  sleep 1 & sros
  wait
  NEEDS_ROS=0
fi
rostopic echo "$@" 
}

# Function to search for service containing string
function fservice(){
if [ $NEEDS_ROS == 1 ]; then
  sleep 1 & sros
  wait
  NEEDS_ROS=0
fi
rosservice list | grep "$@" 
}

# Function to print all services out
function lservices(){
if [ $NEEDS_ROS == 1 ]; then
  sleep 1 & sros
  wait
  NEEDS_ROS=0
fi
rosservice list
}

# to call service
function cservice(){
if [ $NEEDS_ROS == 1 ]; then
  sleep 1 & sros
  wait
  NEEDS_ROS=0
fi
rosservice call "$@"
}

# to ping internet
function pingi(){
    if ! ping -c 2 google.com; then
        echo "No Internet Connection"
        return 0
    else
        echo "Internet Connected"
        return 1
    fi
}



###################################
#NEPI folder shortcuts
export AI="/mnt/nepi_storage/ai_models"
export AIF="/opt/nepi/nepi_engine/share/nepi_ai_ifs"
export API="/opt/nepi/nepi_engine/lib/python3/dist-packages/nepi_api"
export APPS="/opt/nepi/nepi_engine/share/nepi_apps"
export AUTO="/mnt/nepi_storage/automation_scripts"
export CFG="/mnt/nepi_storage/user_cfg"
export AUTO="/mnt/nepi_storage/automation_scripts"
export DATA="/mnt/nepi_storage/data"
export DIST="/opt/nepi/nepi_engine/lib/python3/dist-packages"
export DRIVERS="/opt/nepi/nepi_engine/lib/nepi_drivers"
export ETC="/opt/nepi/nepi_engine/etc"
export INSTALL="/mnt/nepi_storage/intstall"
export LAUNCH="/opt/nepi/nepi_engine/share/nepi_env/launch"
export LIB="/opt/nepi/nepi_engine/lib"
export LIBSDK="/opt/nepi/nepi_engine/lib/nepi_sdk"
export MANAGERS="/opt/nepi/nepi_engine/lib/nepi_managers"
export NFI="/mnt/nepi_storage/nepi_full_img"
export NFIA="/mnt/nepi_storage/nepi_full_img_archive"
export ENGINE="/opt/nepi/nepi_engine"
export RUI="/opt/nepi/nepi_rui/src/rui_webserver/rui-app/src"
export RUI_ENV="/opt/nepi/nepi_rui"
export SDK="/opt/nepi/nepi_engine/lib/python3/dist-packages/nepi_sdk"
export SHARE="/opt/nepi/nepi_engine/share"
export BUILD="/mnt/nepi_storage/nepi_src/nepi_engine_ws"
export SRC="/mnt/nepi_storage/nepi_src/nepi_engine_ws/src"
export SRCRUI="/mnt/nepi_storage/nepi_src/nepi_engine_ws/src/nepi_engine/nepi_rui/src/rui_webserver/rui-app/src"
export TMP="/mnt/nepi_storage/tmp"
export TRAIN="/mnt/nepi_storage/ai_training"
export DRIVE="/mnt/nepi_storage"

# NEPI navigation shortcuts

alias ai="cd $AI"
alias aif="cd $AIF"
alias api="cd $API"
alias apps="cd $APPS"
alias auto="cd $AUTO"
alias cfg="cd $CFG"
alias data="cd $DATA"
alias dist="cd $DIST"
alias drivers="cd $DRIVERS"
alias etc="cd $ETC"
alias intstall="cd $INSTALL"
alias launch="cd $LAUNCH"
alias lib="cd $LIB"
alias libsdk="cd $LIBSDK"
alias managers="cd $MANAGERS"
alias nfi="cd $NFI"
alias nfia="cd $NFIA"
alias engine="cd $ENGINE"
alias rui="cd $RUI"
alias rui_env="cd $RUI_ENV"
alias sdk="cd $SDK"
alias share="cd $SHARE"
alias src="cd $SRC"
alias srcrui="cd $SRCRUI"
alias tmp="cd $TMP"
alias train="cd $TRAIN"
alias drive="cd $DRIVE"


# NEPI build shortcuts
alias nepibld="
cd $BUILD
./build_nepi_complete.sh"

# NEPI build shortcuts
alias codebld="
cd $BUILD
./build_nepi_code.sh"

# NEPI build shortcuts
alias ruibld="
cd $BUILD
./build_nepi_rui.sh"

# NEPI stop and start shortcuts
alias nepistop="sudo systemctl stop nepi_engine"
alias nepistart="sudo /opt/nepi/nepi_engine/etc/nepi_env/nepi_launch.sh"



# Print out the nepi shortcuts
function nepi(){
    text="
    #############################
    ## NEPI function shortcuts ##
    #############################
    # ftext = Find text in files recursively
    # ffile = Find filenames with text match recursively
    # sros = source ros bash setup
    # ltopics = List all active topics
    # ftopic = Find topics containing provided string
    # etopic = Echo to provided topic
    # lservices = List all active services
    # fservice = Find services containing provided string
    # cservice = Call service
    # pingi = Check for internet
    #
    #############################
    ## NEPI run shortcuts ##
    #############################
    # nepibld = build/deploy all nepi repos and RUI
    # codebld = build/deploy all nepi repos
    # ruibld = build/deploy rui system
    #
    #############################
    ## NEPI run shortcuts ##
    #############################
    # nepistart = start the nepi processes
    # nepistop = stop the nepi processes
    #
    ################################
    ## NEPI folder shortcuts ##
    ################################
    ai = /mnt/nepi_storage/ai_models
    aifs = /opt/nepi/nepi_engine/share/nepi_aifs
    api = /opt/nepi/nepi_engine/lib/python3/dist-packages/nepi_api
    apps = /opt/nepi/nepi_engine/share/nepi_apps
    auto = /mnt/nepi_storage/automation_scripts
    cfg = /mnt/nepi_storage/user_cfg
    data = /mnt/nepi_storage/data
    dist = /opt/nepi/nepi_engine/lib/python3/dist-packages/
    drivers = /opt/nepi/nepi_engine/lib/nepi_drivers
    engine = /opt/nepi/nepi_engine
    etc = /opt/nepi/nepi_engine/etc
    intstall = /mnt/nepi_storage/intstall
    lib = /opt/nepi/nepi_engine/lib
    libsdk = /opt/nepi/nepi_engine/lib/nepi_sdk
    managers = /opt/nepi/nepi_engine/lib/nepi_managers
    nfi = /mnt/nepi_storage/nepi_full_img
    nfia = /mnt/nepi_storage/nepi_full_img_archive
    rui = /opt/nepi/nepi_rui/src/rui_webserver/rui-app/src
    rui_env = /opt/nepi/nepi_rui
    sdk = /opt/nepi/nepi_engine/lib/python3/dist-packages/nepi_sdk
    share = /opt/nepi/nepi_engine/share
    src = /mnt/nepi_storage/nepi_src/nepi_engine_ws/src
    srcrui = /mnt/nepi_storage/nepi_src/nepi_engine_ws/src/nepi_engine/nepi_rui/src/rui_webserver/rui-app/src
    tmp = /mnt/nepi_storage/tmp
    train = /mnt/nepi_storage/ai_training
    drive = /mnt/nepi_storage
    "
    echo "$text"
}



###################################
#Env Setup
###################################

# NVM Config
export NVM_DIR="$HOME/.nvm"
[ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"  # This loads nvm
[ -s "$NVM_DIR/bash_completion" ] && \. "$NVM_DIR/bash_completion"  # This loads nvm bash_completion


# Python Config
export LD_LIBRARY_PATH=/usr/local/lib:$LD_LIBRARY_PATH
export PYTHONPATH=$PYTHONPATH:/opt/nepi/nepi_engine/lib/nepi_drivers/:$PYTHONPATH
export PYTHONPATH=/usr/local/lib/python3.10/site-packages/:$PYTHONPATH


# System Config
export CMAKE_POLICY_VERSION_MINIMUM=3.5
export SETUPTOOLS_USE_DISTUTILS=stdlib
export LD_PRELOAD=/usr/local/lib/libOpen3D.so
export PATH="/opt/nepi/nepi_engine/etc/":$PATH




# Inform if this is the target hardware
export NEPI_REMOTE_SETUP=0
